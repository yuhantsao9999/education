<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>class</title>
    <link rel="stylesheet" href="./css/profile_teacher.css" />
</head>

<body class="about">
    <div id="header">
        <div class="full-width container clearfix">
            <div>
                <div class="nav_item_bar">
                    <a href="./index.html"> <img id="logo" src="./img/logo.png" alt="logo"></a>
                    <a class="search" href="">探索</a>
                    <!-- <input id="search" style="font-size:20px" onkeyup="search_course_enter()"> -->
                    <div class="search__container">
                        <input class="search__input" type="text" placeholder="Search" onkeyup="search_course_enter()">
                    </div>
                    <button onclick="search_course()" type="submit"></button>
                    <div id="nav" class="col-8">
                        <ul class="clearfix" id="clearfix">
                            <li class="active"><a href="./course_input.html">我要開課</a></li>
                            <li class="boundary"><a href="./profile_student.html">我的課表</a></li>
                            <!-- <li><a href="./sign_in.html">登入</a></li>
                                <li><a href="./profile.html">hi yuhan!</a></li> -->
                            <!-- <li><a href="./sign_up.html"><i class="icon-search"></i> 註冊</a></li> -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-------大報 ------>
    <div id="content">
        <div class="header">
        </div>

        <!------- 內容 ------->

        <div class="total_container">
            <div class="container">
                <div class="col-4" id="table">
                    <a href="./profile_student.html">
                        <div class="profile_class">
                            我修的課
                        </div>
                    </a>
                    <a href="./profile.html">
                        <div class="user_info">
                            我的公開資訊
                        </div>
                    </a>
                    <a href="./profile_done.html">
                        <div class="profile_finish">
                            已完成的課程
                        </div>
                    </a>
                    <a href="./profile_teacher.html">
                        <div class="teacher_class">
                            我開的課
                        </div>
                    </a>
                </div>

                <div class="col-6" id="profile_add_info">
                    <!-- <h3>所有課程</h3> -->
                    <!-- <div class="profile_info">
                        <a href="#">
                            <img src="./img/3.png" alt="">
                        </a>
                        <div>
                            <a href="#">
                                <div class="profile_class_info">testtest</div>
                            </a>
                            <input type="button" value="編輯課程" class="profile_info_button">

                        </div>
                    </div> -->

                </div>


            </div>
        </div>
    </div>


    <!------- footer ------->
    <!-- <div id="footer" class="dark">

        <div class="info">
            <div class="container">

                <div class="row">
                    <div class="col-3">
                        <img id="logo" src="./img/logo.png" alt="logo" />
                        <p>讓學習<br>無時無刻無距離</p>
                    </div>
                    <div class="col-3">
                        <h4 class="title">recent posts</h4>
                        <ul class="common-list">
                            <li><a href="#">standard blog post</a></li>
                            <li><a href="#">quotation post</a></li>
                            <li><a href="#">audio post</a></li>

                        </ul>
                    </div>
                    <div class="col-3">
                        <h4 class="title">快速連結</h4>
                        <ul class="common-list">
                            <li><a href="#">關於我們</a></li>
                            <li><a href="#">回到主頁</a></li>
                            <li><a href="./course_input.html">我要開課</a></li>
                        </ul>
                    </div>

                </div>

            </div>
        </div>

        <div class="bottom">
            <div class="container clearfix">

                <div class="copyright">
                    <div class="title">Copyright 2019 by <a href="#">yuhan</a> | All Rights Reserved</div>
                </div>


            </div>
        </div>
    </div> -->

    <a href="#header" id="go-top"><i class="icon-up-open"></i></a>

</body>
<script>
    //search
    function search_course_enter() {
        if (event.keyCode == 13)
            search_course();
    }

    // get search course data 
    function search_course() {
        var client_keyword = document.getElementById("search").value;

        // function ucfirst(str) {
        var lowcase_keyword = client_keyword.toLowerCase();
        var keyword_arr = lowcase_keyword.split(' ');
        for (var i = 0; i < keyword_arr.length; i++) {
            var result = keyword_arr[i].substring(0, 1).toUpperCase() + keyword_arr[i].substring(1).toLowerCase();
        }
        // console.log(result)
        window.location.replace("./search.html?keyword=" + result);
    }



    //get teacher_class
    const accessToken = localStorage.getItem("accessToken")
        // console.log("accessToken" + accessToken)
    var xml = new XMLHttpRequest;
    xml.open('get', '/profile/teacher/class', true);
    xml.setRequestHeader("Authorization", "Bearer" + " " + accessToken);
    xml.send(null);
    xml.onreadystatechange = function() {
        if (xml.readyState == 4) {
            var teacher_class_h3 = document.createElement("h3");
            var teacher_class_Content = document.createTextNode("我開的課");
            teacher_class_h3.appendChild(teacher_class_Content)
            document.getElementById("profile_add_info").appendChild(teacher_class_h3)
            if (xml.responseText == "no set up class") {
                var noSetUpClassContent = document.createTextNode("尚未開設任何課程哦!");
                document.getElementById("profile_add_info").appendChild(noSetUpClassContent);
            } else {
                var obj = JSON.parse(xml.responseText);
                console.log(obj)
                    // <div class="profile_info"> profileDiv
                    //         <a href="#">classImg_a
                    //             <img src="./img/3.png" alt="">classImg
                    //         </a>
                    //         <div>classDiv_a_div
                    //             <a href="#">classDiv_a
                    //                 <div class="profile_class_info">testtest</div>classDiv
                    //             </a>
                    //          <input type="button" value="編輯課程" class="profile_info_button">

                //         </div>
                // </div>

                for (var i = 0; i < obj.length; i++) {
                    //替換課程圖片
                    var classImg = document.createElement("img");
                    classImg.src = "https://cad-education-project.s3-ap-northeast-1.amazonaws.com/class-video-picture/" + obj[i].main_image
                    var classDiv = document.createElement("div");
                    var profileDiv = document.createElement("div");
                    var titleContent = document.createTextNode(obj[i].course_title);
                    console.log(titleContent)
                    classDiv.className = "profile_class_info";
                    profileDiv.className = "profile_info"

                    var classImg_a = document.createElement("a");
                    classImg_a.href = ("course.html?title=" + obj[i].course_title)
                    var classDiv_a = document.createElement("a");
                    classDiv_a.href = ("course.html?title=" + obj[i].course_title)

                    classImg_a.appendChild(classImg)

                    classDiv_a.appendChild(classDiv)
                    classDiv.appendChild(titleContent)


                    var classDiv_a_div = document.createElement("div");
                    var button_input = document.createElement("input");
                    button_input.type = "button"
                    button_input.setAttribute("onClick", "edit_course(" + obj[i].course_id + ")");
                    button_input.value = "編輯課程"
                    button_input.className = "profile_info_button"

                    classDiv_a_div.appendChild(classDiv_a)
                    classDiv_a_div.appendChild(button_input)
                    profileDiv.appendChild(classImg_a)
                    profileDiv.appendChild(classDiv_a_div)

                    document.getElementById("profile_add_info").appendChild(profileDiv)

                }

            }
        }
    }


    //編輯課程
    function edit_course(obj) {
        window.location.assign("./course_update.html?course_id=" + obj)
    }


    //user icon
    var sign_li = document.createElement("li");
    var signContent = document.createTextNode("登出");
    var sign_a = document.createElement("a");
    sign_a.setAttribute("onClick", "log_out()");
    sign_a.appendChild(signContent)
    sign_li.appendChild(sign_a)
    document.getElementById("clearfix").appendChild(sign_li)
        //log out
    function log_out() {
        localStorage.removeItem('accessToken');
        alert("帳號登出囉!")
        window.location.replace("./sign_in.html");
    }
</script>

</html>